(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{OL3V:function(t,i,e){"use strict";var n=e("ntgM");e.n(n).a},Zg5i:function(t,i,e){"use strict";e.r(i);var n={computed:{contactId:function(){return this.$route.params.id},contact:function(){var t=this;return this.$store.state.contacts.find(function(i){return i.id==t.contactId})},fields:function(){return this.$store.state.fields}},created:function(){if(void 0===this.contact)return this.$router.push("/")},data:function(){return{patterns:{field:".+:.+"},isChanged:!1,history:{list:[],max_length:10,now:1}}},methods:{createNewEmptyField:function(){this.$store.commit("addFields",{contact_id:this.contact.id})},deleteField:function(t){var i=t.id;confirm("Удалить поле?")&&this.$store.commit({type:"deleteField",id:i})},saveSnap:function(t){this.isChanged&&(this.isChanged=!1,this.history.list.push({field:t,value:t.value,time:(new Date).getTime()}),this.history.list.length>this.history.max_length&&(this.history.list=this.history.list.slice(1,this.history.max_length)),this.history.now=1)},prevSnapForField:function(t){var i=this.history.list.filter(function(i){return i.field.id===t.id});if(0!==i.length&&confirm("Вернуть предыдущее значение?")){var e=i[i.length-2];t.value=e.value}},prevSnap:function(){var t=this.history.list;if(void 0!==t){var i=t.length-this.history.now++,e=t[i];e&&(e.field.value=e.value),i<=0&&(this.history.now=t.length)}}}},s=(e("OL3V"),e("KHd+")),a=Object(s.a)(n,function(){var t=this,i=t.$createElement,e=t._self._c||i;return t.contact?e("div",{staticClass:"layout"},[e("div",{staticClass:"contact-head"},[e("h2",{staticClass:"contact-title center"},[t._v("\n      Информация о контакте "+t._s(t.contact.name)+"\n\n      "),e("i",{staticClass:"fa fa-history",attrs:{title:"Undo"},on:{click:function(i){return t.prevSnap()}}}),t._v(" "),e("router-link",{attrs:{to:"/",title:"close"}},[e("i",{staticClass:"fa fa-times"})])],1)]),t._v(" "),e("div",{staticClass:"contact-body"},[e("div",{staticClass:"body-items"},t._l(t.fields.filter(function(i){return i.contact_id===t.contact.id}),function(i){return e("div",{key:i.id,staticClass:"body-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:i.value,expression:"field.value"}],staticClass:"body-input",attrs:{type:"text",pattern:t.patterns.field},domProps:{value:i.value},on:{change:function(i){t.isChanged=!0},blur:function(e){return t.saveSnap(i)},input:function(e){e.target.composing||t.$set(i,"value",e.target.value)}}}),t._v(" "),e("i",{staticClass:"fa fa-reply",attrs:{title:"Undo"},on:{click:function(e){return t.prevSnapForField(i)}}}),t._v(" "),e("i",{staticClass:"fa fa-trash",attrs:{title:"Delete"},on:{click:function(e){return t.deleteField(i)}}})])}),0),t._v(" "),e("div",{staticClass:"body-panel"},[e("span",{staticClass:"panel-new_field",on:{click:function(i){return t.createNewEmptyField()}}},[t._v("\n          Добавить поле\n        ")])])])]):t._e()},[],!1,null,"ff5a9918",null);i.default=a.exports},ntgM:function(t,i,e){}}]);